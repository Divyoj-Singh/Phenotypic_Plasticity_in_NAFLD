function dxdt = interactions(t,x)
%% X1: HNF4A, X2: HNF1A, X3:PPARG, X4:SREBF1,

dxdt = zeros(4,1);


% all the notation used here is from first to second, that the value
% corresponds to the effect of the first gene on the second

%%% Production Rates:
g_HNF4A = 0.4540700422860051; 
g_HNF1A = 0.05705569053323611;
g_PPARG = 0.06283939658384676; 
g_SREBF1= 1.1058054056141339; 

% Degradation Rates:
k_HNF4A = 0.049119799999999997;
k_HNF1A = 0.049445600000000006;
k_PPARG = 0.08;
k_SREBF1 = 0.15984530000000001; 

% Thresholds
x_HNF4A_HNF4A = 3;
x_SREBF1_SREBF1 = 5.25;
x_PPARG_PPARG = 6.32011;
x_HNF1A_HNF1A = 0.8;

x_SREBF1_HNF4A = 5; 
x_HNF1A_PPARG = 0.6740759999999998;

x_HNF4A_HNF1A = 5.108258999999999;
x_HNF1A_HNF4A = 0.8;
x_SREBF1_PPARG = 5.25;
x_PPARG_SREBF1 = 9.28398;

% Lambdas (fold change)
l_HNF4A_HNF4A = 4;
l_PPARG_PPARG = 9.514515;
l_SREBF1_SREBF1 = 4;
l_HNF1A_HNF1A = 2;

l_HNF4A_HNF1A = 5.328115;
l_HNF1A_HNF4A = 4; 
l_SREBF1_PPARG =  3;
l_PPARG_SREBF1 = 3.7292400000000003; 

l_SREBF1_HNF4A = 0.415335;
l_HNF1A_PPARG = 0.680057;

% co-operativity
n_HNF4A_HNF4A = 4.0;
n_HNF4A_HNF1A = 4.0;
n_HNF1A_HNF4A = 3.0;
n_HNF1A_HNF1A = 4.0;

n_HNF1A_PPARG  = 4;
n_SREBF1_HNF4A = 2.0;

n_PPARG_PPARG  = 5.0; 
n_SREBF1_PPARG = 2.0;
n_PPARG_SREBF1 = 2.0;
n_SREBF1_SREBF1= 2.0;

%% Calling of hill function:
H_HNF4A_HNF4A=hill(x(1),x_HNF4A_HNF4A,l_HNF4A_HNF4A,n_HNF4A_HNF4A);
H_HNF1A_HNF4A=hill(x(2),x_HNF1A_HNF4A,l_HNF1A_HNF4A,n_HNF1A_HNF4A);
H_HNF4A_HNF1A=hill(x(1),x_HNF4A_HNF1A,l_HNF4A_HNF1A,n_HNF4A_HNF1A);
H_HNF1A_HNF1A=hill(x(2),x_HNF1A_HNF1A,l_HNF1A_HNF1A,n_HNF1A_HNF1A);

H_SREBF1_HNF4A=hill(x(4),x_SREBF1_HNF4A,l_SREBF1_HNF4A,n_SREBF1_HNF4A);
H_HNF1A_PPARG=hill(x(2),x_HNF1A_PPARG,l_HNF1A_PPARG,n_HNF1A_PPARG);

H_PPARG_PPARG=hill(x(3),x_PPARG_PPARG,l_PPARG_PPARG,n_PPARG_PPARG);
H_SREBF1_PPARG=hill(x(4),x_SREBF1_PPARG,l_SREBF1_PPARG,n_SREBF1_PPARG);
H_PPARG_SREBF1=hill(x(3),x_PPARG_SREBF1,l_PPARG_SREBF1,n_PPARG_SREBF1);
H_SREBF1_SREBF1=hill(x(4),x_SREBF1_SREBF1,l_SREBF1_SREBF1,n_SREBF1_SREBF1);

%% Equations:
% the last term in each of these equations is the noise term. 
dxdt(1) = g_HNF4A*H_SREBF1_HNF4A*H_HNF4A_HNF4A*H_HNF1A_HNF4A - k_HNF4A*x(1) +0.1*randn(1);
dxdt(2) = g_HNF1A*H_HNF4A_HNF1A*H_HNF1A_HNF1A - k_HNF1A*x(2)+ 0.1*randn(1);
dxdt(3) = g_PPARG*H_HNF1A_PPARG*H_SREBF1_PPARG*H_PPARG_PPARG - k_PPARG*x(3) + 15*randn(1);
dxdt(4) = g_SREBF1*H_PPARG_SREBF1*H_SREBF1_SREBF1 - k_SREBF1*x(4)+ 0.1*randn(1);     

end

